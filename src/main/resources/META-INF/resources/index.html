<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>CodeMirror 5 in Quarkus</title>

    <link rel="icon" type="image/png" href="favicon.png" />

    <!-- CodeMirror 5 CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
    <!-- Optional theme (Monokai) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/monokai.min.css" />

    <style>
        body {
          margin: 0;
          padding: 0;
          background: #1e1e1e;
          color: #eee;
          font-family: sans-serif;
          height: 100vh;
          display: flex;
          flex-direction: column;
        }

        h1 {
          padding: 1em;
          margin: 0;
          background: #2c2c2c;
        }

        #editor-wrapper {
          flex: 1;
          padding: 1em;
        }

        .CodeMirror {
          height: 100%;
          font-size: 16px;
        }

        .headline-line {
          font-size: 2em !important;
          color: #ffffff !important;
          font-weight: bold;
        }
    </style>
</head>
<body>

<h1>Simple CodeMirror 5 Editor</h1>

<div id="editor-wrapper">
    <textarea id="editor"># Hello World

This is a note editor using CodeMirror 5.
You can customize syntax highlighting, keybindings, and more.</textarea>
</div>

<!-- CodeMirror core JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<!-- Optional: Keymaps (Sublime, Vim, etc.) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/keymap/sublime.min.js"></script>

<script>
    const editor = CodeMirror.fromTextArea(document.getElementById('editor'), {
      mode: 'markdown',
      theme: 'monokai',
      lineNumbers: true,
      lineWrapping: true,
      keyMap: 'sublime',
      extraKeys: {
        'Ctrl-S': function(cm) {
          const content = cm.getValue();
          const cursor = cm.getCursor();
          alert('Ctrl+S pressed!\n\nContent:\n' + content + '\n\nCursor at line ' + cursor.line);
        }
      }
    });

    function highlightHeadlines() {
      const totalLines = editor.lineCount();

      // First clear all old styles
      for (let i = 0; i < totalLines; i++) {
        editor.removeLineClass(i, "wrap", "headline-line");
      }

      // Apply to matching lines
      for (let i = 0; i < totalLines; i++) {
        const lineContent = editor.getLine(i);
        if (/^#/.test(lineContent)) {
          editor.addLineClass(i, "wrap", "headline-line");
        }
      }
    }

    // Run on load
    highlightHeadlines();

    // Run on change
    editor.on("change", highlightHeadlines);
</script>

</body>
</html>
